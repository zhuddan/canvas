{"version":3,"file":"index.cjs.js","sources":["../../../node_modules/.pnpm/eventemitter3@5.0.1/node_modules/eventemitter3/index.js","../../src/utils.ts","../../src/app.ts","../../src/coordinate/ObservablePoint.ts","../../src/renderables/renderable.ts","../../src/style/abstract-style.ts","../../src/style/text-style.ts","../../src/renderables/picture.ts","../../src/renderables/shape.ts","../../src/renderables/text.ts"],"sourcesContent":["'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","import type { PointData } from './coordinate/PointData'\nimport type { TextStyle } from './style/text-style'\n\n/**\n *  输出 px\n * @param val\n */\nexport function formatWithPx(val: string | number) {\n  return typeof val === 'string' ? val : `${val}px`\n}\n\n/**\n * 创造 [CSS-font](https://developer.mozilla.org/zh-CN/docs/Web/CSS/font) 字符串\n * 由于 canvas 绘制的差异性部分属性不生效故舍弃\n */\nexport function createCanvasFontString({\n  fontFamily,\n  fontSize,\n  fontStyle = 'normal',\n  fontWeight = 'normal',\n}: TextStyle): string {\n  const _fontSize = typeof fontSize === 'string' ? fontSize : `${fontSize}px`\n  return `${fontStyle} ${fontWeight} ${_fontSize} ${fontFamily}`\n}\n\n/**\n * 计算最小值\n * @param numbers\n */\nexport function calcMin(numbers: number[]) {\n  return numbers.reduce((a, b) => {\n    return a < b ? a : b\n  })\n}\n/**\n * 计算最大值\n * @param numbers\n */\nexport function calcMax(numbers: number[]) {\n  return numbers.reduce((a, b) => {\n    return a > b ? a : b\n  })\n}\n/**\n * 计算差异\n * @param numbers\n */\nexport function calcDiff(numbers: number[]) {\n  return calcMax(numbers) - calcMin(numbers)\n}\n\n/**\n * 确保输入值在 min 和 max 之间，若超出边界则返回边界\n * @param input\n * @param min\n * @param max\n */\nexport function ensureBetween(input: number, min: number = 0, max: number = 1) {\n  return input <= min ? min : input >= max ? max : input\n}\n\n/**\n * 创建代理\n * @param value\n * @param cb\n */\nexport function createProxy<T extends object>(value: T, cb?: (property: string, newValue: any) => void): T {\n  return new Proxy<T>(value, {\n    set: (target, property, newValue) => {\n      target[property as keyof T] = newValue\n      cb?.(property as string, newValue)\n      return true\n    },\n  })\n}\n\nexport enum ENV {\n  WX = 'WX',\n  WEB = 'WEB',\n  UNKNOWN = 'UNKNOWN',\n  UNI_APP = 'UNI_APP',\n}\n\nexport function getEnv() {\n  if (typeof uni !== 'undefined')\n    return ENV.UNI_APP\n  if (typeof wx !== 'undefined')\n    return ENV.WX\n  if (typeof window !== 'undefined' && typeof window.document !== 'undefined')\n    return ENV.WEB\n  return ENV.UNKNOWN\n}\n\n/**\n * Draws a rectangle with rounded corners compatible with different environments.\n *\n * @param {CanvasRenderingContext2D} ctx - The canvas rendering context.\n * @param {PointData} position - The position of the rectangle.\n * @param {PointData} size - The size of the rectangle.\n * @param {number} [rounded] - The radius of the rounded corners.\n *\n * @return {void}\n */\nexport function drawRectCompatible(\n  ctx: CanvasRenderingContext2D,\n  position: PointData,\n  size: PointData,\n  rounded?: number,\n) {\n  rounded = rounded ?? 0\n  rounded = Math.min(rounded, size.x / 2, size.y / 2)\n  ctx.beginPath()\n  if (rounded) {\n    if (getEnv() === ENV.WX) {\n      // 左上角到右上角\n      ctx.moveTo(position.x + rounded, position.y)\n      ctx.arcTo(position.x + size.x, position.y, position.x + size.x, position.y + rounded, rounded)\n      // 右上角到右下角\n      ctx.arcTo(position.x + size.x, position.y + size.y, position.x + size.x - rounded, position.y + size.y, rounded)\n      // 右下角到左下角\n      ctx.arcTo(position.x, position.y + size.y, position.x, position.y + size.y - rounded, rounded)\n      // 左下角到左上角\n      ctx.arcTo(position.x, position.y, position.x + rounded, position.y, rounded)\n      // 闭合路径\n      ctx.closePath()\n    }\n    else {\n      ctx.roundRect(position.x, position.y, size.x, size.y, rounded)\n    }\n  }\n  else {\n    ctx.rect(position.x, position.y, size.x, size.y)\n  }\n}\n","import EventEmitter from 'eventemitter3'\nimport type { Renderable } from './renderables/renderable'\nimport { ENV, formatWithPx, getEnv } from './utils'\n\nexport interface AppOptions {\n  /**\n   *  画布宽度\n   */\n  width?: number\n  /**\n   *  画布高度\n   */\n  height?: number\n  /**\n   *  是否开启dpr\n   */\n  dpr?: boolean | number\n  /**\n   *  `画布元素`或`画布id(微信小程序或者uni-app)`或者`document.querySelector可以接受的字符串`\n   */\n  canvas?: HTMLCanvasElement | string\n  /**\n   * backgroundColor\n   */\n  backgroundColor?: string\n  /**\n   * 画布resize到的元素 仅 web 支持\n   */\n  resizeTo?: HTMLElement | Window | string\n}\n\nexport class App extends EventEmitter<{\n  render: []\n  ready: []\n}> {\n  private ctx!: CanvasRenderingContext2D\n  private _ready = false\n  protected _env = getEnv()\n  canvas!: HTMLCanvasElement\n  ticker!: Ticker\n  dpr = 1\n  width = 0\n  height = 0\n  _width = 0\n  _height = 0\n  removeResizeEvent?: () => void\n  constructor(private options: AppOptions = {}) {\n    super()\n    this.validateAppOptions(options)\n    this.initDpr()\n    this.initTicker()\n    this.initCanvas()\n  }\n\n  onReady(fn: () => void) {\n    if (this._ready) {\n      fn()\n    }\n    else {\n      this.once('ready', () => {\n        fn()\n      })\n    }\n  }\n\n  private validateAppOptions(appOptions: AppOptions) {\n    if (this._env === ENV.WX && !appOptions.canvas) {\n      console.error('当前为非document环境, 无法使用 document.createElement(\\'canvas\\'),\\n 请传入canvas元素或者canvasId')\n    }\n  }\n\n  private initDpr() {\n    const { dpr = true } = this.options\n    if (typeof dpr === 'boolean') {\n      this.dpr = window.devicePixelRatio ?? 1\n    }\n    else {\n      this.dpr = dpr\n    }\n  }\n\n  private initCanvas() {\n    const canvas = this.options.canvas\n    if (canvas) {\n      if (typeof canvas === 'string') {\n        if (this._env === ENV.WEB) {\n          this.canvas = document.querySelector(canvas) as HTMLCanvasElement\n        }\n        else {\n          let query: WechatMiniprogram.SelectorQuery | UniNamespace.SelectorQuery\n          if (this._env === ENV.WX) {\n            query = wx.createSelectorQuery()\n          }\n          else {\n            query = uni.createSelectorQuery()\n          }\n          query.select('#myCanvas')\n            .fields({ node: true, size: true }, undefined as any)\n            .exec((res) => {\n              const canvas = res[0].node as HTMLCanvasElement\n              this.canvas = canvas\n              this.initCanvasRenderingContext2D()\n            })\n        }\n      }\n      else {\n        this.canvas = canvas\n        this.initCanvasRenderingContext2D()\n      }\n    }\n    else {\n      this.canvas = document.createElement('canvas')!\n      this.initCanvasRenderingContext2D()\n    }\n  }\n\n  private initCanvasRenderingContext2D() {\n    const {\n      width = this._env === ENV.WX ? 300 : 600,\n      height = this._env === ENV.WX ? 150 : 300,\n      resizeTo,\n    } = this.options\n    if (!this.canvas)\n      return\n    if (this.canvas.style) {\n      this.canvas.style.backgroundColor = this.options.backgroundColor ?? 'transparent'\n      if (resizeTo) {\n        this.initResizeEvent()\n      }\n      else {\n        this.width = width\n        this.height = height\n      }\n    }\n    else {\n      this.canvas.width = width * this.dpr\n      this.canvas.height = height * this.dpr\n      this.width = width\n      this.height = width\n    }\n\n    this.ctx = this.canvas.getContext('2d')!\n    this._ready = true\n    this.ticker.init(this.canvas, true)\n    this.emit('ready')\n  }\n\n  initResizeEvent(): void {\n    if (!this.options.resizeTo) {\n      return\n    }\n    const resizeTo = this.options.resizeTo\n    const target = typeof resizeTo === 'string'\n      ? document.querySelector(resizeTo) as HTMLElement\n      : resizeTo\n    if (target instanceof Window) {\n      const resizeHandler = () => {\n        this.width = window.innerWidth\n        this.height = window.innerHeight\n      }\n      const _resizeHandler = resizeHandler.bind(this)\n      window.addEventListener('resize', _resizeHandler)\n      this.removeResizeEvent = () => {\n        window.removeEventListener('resize', _resizeHandler)\n      }\n      resizeHandler()\n    }\n    else {\n      const resizeHandler = () => {\n        const width = target.clientWidth\n        const height = target.clientHeight\n        this.width = width\n        this.height = height\n      }\n      const resizeObserver = new ResizeObserver(resizeHandler)\n      resizeObserver.observe(target)\n      this.removeResizeEvent = () => {\n        resizeObserver.disconnect()\n      }\n      resizeHandler()\n    }\n  }\n\n  private get shouldResize() {\n    return this.width !== this._width || this.height !== this._height\n  }\n\n  resize() {\n    if (this.shouldResize) {\n      this.canvas.style.width = formatWithPx(this.width)\n      this.canvas.style.height = formatWithPx(this.height)\n      this.canvas.width = this.width * this.dpr\n      this.canvas.height = this.height * this.dpr\n      this._width = this.width\n      this._height = this.height\n    }\n  }\n\n  private initTicker() {\n    this.ticker = new Ticker()\n    this.ticker.add(this.update.bind(this))\n  }\n\n  private beforeRender() {\n    this.ctx.save()\n  }\n\n  private afterRender() {\n    this.ctx.restore()\n  }\n\n  children: Renderable[] = []\n\n  add(...objects: Renderable[]) {\n    for (let index = 0; index < objects.length; index++) {\n      const object = objects[index]\n      this.children.push(object)\n      object.onAdd(this)\n    }\n  }\n\n  remove(...objects: Renderable[]) {\n    for (let index = 0; index < objects.length; index++) {\n      const object = objects[index]\n      const delIndex = this.children.indexOf(object)\n      if (delIndex !== -1) {\n        object.onRemove()\n        this.children.splice(delIndex, 1)\n      }\n    }\n  }\n\n  private update() {\n    if (!this.children.length) {\n      return\n    }\n    const isDirty = !![...this.children.filter(e => e.dirty)].length || this.shouldResize\n\n    if (!isDirty)\n      return\n\n    if (this.shouldResize) {\n      this.resize()\n    }\n    this.ctx.clearRect(\n      -this.canvas.width,\n      -this.canvas.height,\n      this.canvas.width * 2,\n      this.canvas.height * 2,\n    )\n\n    const shouldRender = [...this.children].filter(e => e.shouldUpdate)\n    while (shouldRender.length) {\n      this.beforeRender()\n      const child = shouldRender.shift()!\n      child.render(this.ctx)\n      child.dirty = false\n      child._renderId++\n      child.emit('render')\n      this.afterRender()\n    }\n  }\n\n  toDataURL(type?: string, quality?: any) {\n    return this.canvas.toDataURL(type, quality)\n  }\n\n  toDataURLAsync(type?: string, quality?: any) {\n    return new Promise<string>((resolve) => {\n      this.once('render', () => {\n        resolve(this.toDataURL(type, quality))\n      })\n    })\n  }\n\n  wrapperRender(fn: (ctx: CanvasRenderingContext2D) => any) {\n    this.beforeRender()\n    fn(this.ctx)\n    this.afterRender()\n  }\n}\n\nclass Ticker {\n  requestAnimationFrame?: typeof requestAnimationFrame\n  cancelAnimationFrame?: typeof cancelAnimationFrame\n  myReq: number = 0\n  private isRunning: boolean = false\n  handler: ((time: number) => void)[] = []\n  protected _env = getEnv()\n  constructor(protected autoStart: boolean = true) {\n\n  }\n\n  init(canvas: HTMLCanvasElement, autoStart: boolean) {\n    if (this._env === ENV.WX) {\n      this.requestAnimationFrame = (canvas as any).requestAnimationFrame.bind(canvas)\n      this.cancelAnimationFrame = (canvas as any).requestAnimationFrame.bind(canvas)\n    }\n    else if (window) {\n      this.requestAnimationFrame = window.requestAnimationFrame.bind(window)\n      this.cancelAnimationFrame = window.cancelAnimationFrame.bind(window)\n    }\n    if (autoStart) {\n      this.start()\n    }\n  }\n\n  add(fn: (time: number) => void) {\n    this.handler.push(fn)\n  }\n\n  removeAll() {\n    this.handler = []\n  }\n\n  remove(fn: (time: number) => void) {\n    const index = this.handler.indexOf(fn)\n    if (index !== -1) {\n      this.handler.splice(index, 1)\n    }\n  }\n\n  start() {\n    this.isRunning = true\n    if (this.requestAnimationFrame) {\n      this.myReq = this.requestAnimationFrame(this.update.bind(this))\n    }\n  }\n\n  stop() {\n    if (this.isRunning && this.myReq) {\n      this.cancelAnimationFrame?.(this.myReq)\n      this.isRunning = false\n    }\n  }\n\n  update() {\n    if (!this.isRunning)\n      return\n    if (this.requestAnimationFrame) {\n      this.myReq = this.requestAnimationFrame(this.update.bind(this))\n    }\n    this.handler.forEach(fn => fn(performance.now()))\n  }\n}\n","import type { PointData } from './PointData'\nimport type { PointLike } from './PointLike'\n\nexport interface Observer<T> {\n  _onUpdate: (point?: T) => void\n}\n\nexport class ObservablePoint implements PointLike {\n  public _x: number\n  public _y: number\n  private readonly _observer: Observer<ObservablePoint> | null\n  constructor(observer: Observer<ObservablePoint> | null, x?: number, y?: number) {\n    this._x = x || 0\n    this._y = y || 0\n    this._observer = observer\n  }\n\n  public clone(observer?: Observer<ObservablePoint>): ObservablePoint {\n    return new ObservablePoint(observer ?? this._observer, this._x, this._y)\n  }\n\n  public set(x = 0, y = x): this {\n    if (this._x !== x || this._y !== y) {\n      this._x = x\n      this._y = y\n      this._observer?._onUpdate(this)\n    }\n    return this\n  }\n\n  public copyFrom(p: PointData): this {\n    if (this._x !== p.x || this._y !== p.y) {\n      this._x = p.x\n      this._y = p.y\n      this._observer?._onUpdate(this)\n    }\n    return this\n  }\n\n  public copyTo<T extends PointLike>(p: T): T {\n    p.set(this._x, this._y)\n    return p\n  }\n\n  public equals(p: PointData): boolean {\n    return (p.x === this._x) && (p.y === this._y)\n  }\n\n  get x(): number {\n    return this._x\n  }\n\n  set x(value: number) {\n    if (this._x !== value) {\n      this._x = value\n      this._observer?._onUpdate(this)\n    }\n  }\n\n  get y(): number {\n    return this._y\n  }\n\n  set y(value: number) {\n    if (this._y !== value) {\n      this._y = value\n      this._observer?._onUpdate(this)\n    }\n  }\n\n  [Symbol.iterator]() {\n    let step = 0\n    const properties = [this.x, this.y]\n\n    return {\n      next: () => {\n        if (step < properties.length) {\n          return { value: properties[step++], done: false }\n        }\n        else {\n          return { done: true, value: undefined }\n        }\n      },\n    }\n  }\n}\n","import EventEmitter from 'eventemitter3'\nimport type { App } from '../app'\nimport type { Observer } from '../coordinate/ObservablePoint'\nimport { ObservablePoint } from '../coordinate/ObservablePoint'\nimport type { PointData } from '../coordinate/PointData'\nimport { createProxy, ensureBetween, getEnv } from '../utils'\n\nexport interface ShadowType {\n  /**\n   * [CanvasRenderingContext2D.shadowColor](https://developer.mozilla.org/docs/Web/API/CanvasRenderingContext2D/shadowColor)\n   */\n  color: string\n  /**\n   * [CanvasRenderingContext2D.shadowOffsetX](https://developer.mozilla.org/docs/Web/API/CanvasRenderingContext2D/shadowOffsetX)\n   */\n  x?: number\n  /**\n   * [CanvasRenderingContext2D.shadowOffsetY](https://developer.mozilla.org/docs/Web/API/CanvasRenderingContext2D/shadowOffsetY)\n   */\n  y?: number\n  /**\n   * [CanvasRenderingContext2D.shadowBlur](https://developer.mozilla.org/docs/Web/API/CanvasRenderingContext2D/shadowBlur)\n   */\n  blur?: number\n}\n/**\n * [单位矩阵变化](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/setTransform)\n */\nexport interface RenderableOptions {\n  /**\n   * 元素是否可见\n   */\n  visible?: boolean\n  /**\n   * 透明度\n   */\n  alpha?: number\n  /**\n   * 阴影\n   */\n  shadow?: ShadowType\n  /**\n   * 元素位置x\n   */\n  x?: number\n  /**\n   * 元素位置y\n   */\n  y?: number\n  /**\n   * 元素位置\n   */\n  position?: PointData\n  /**\n   * 单位矩阵变化中心，默认是[0,0]表示左上角，[1,1]表示右下角，[0.5,0.5]表示中心\n   *\n   * 此属性可以很好的控制元素的锚点，不用计算相对位置\n   *\n   * 例如：一个500x500的画布上需要绘制一个上下居中的图片\n   *\n   * ``` ts\n   * const text = new Picture('demo.png',{\n   *  anchor: 0.5\n   * })\n   * ```\n   */\n  anchor?: PointData | number\n  /**\n   * 同 anchor，但是具体坐标，建议使用 anchor\n   */\n  pivot?: PointData | number\n  /**\n   * 旋转角度(弧度)\n   */\n  rotation?: number\n  /**\n   * 缩放比例\n   */\n  scale?: PointData | number\n  /**\n   * 元素倾斜\n   */\n  skew?: PointData\n\n}\n/**\n * 默认的倾斜\n */\nconst defaultSkew = new ObservablePoint(null)\n/**\n * 默认的旋转中心\n */\nconst defaultPivot = new ObservablePoint(null)\n/**\n * 默认的锚点\n */\nconst defaultAnchor = new ObservablePoint(null)\n/**\n * 默认的缩放\n */\nconst defaultScale = new ObservablePoint(null, 1, 1)\n\nexport abstract class Renderable extends EventEmitter<{\n  updateBounds: [width: number, height: number]\n  render: []\n}> implements Observer<ObservablePoint> {\n  protected _env = getEnv()\n  constructor(options: RenderableOptions = {}) {\n    super()\n    this.visible = options.visible ?? true\n    this.alpha = options.alpha ?? 1\n    if (options.shadow) {\n      this.shadow = options.shadow\n    }\n\n    if (options.position) {\n      this.position = options.position\n    }\n    else {\n      this.x = options.x ?? 0\n      this.y = options.y ?? 0\n    }\n    if (options.anchor !== undefined) {\n      this.anchor = options.anchor\n    }\n    if (options.pivot !== undefined) {\n      this.pivot = options.pivot\n    }\n    if (options.rotation !== undefined) {\n      this.rotation = options.rotation\n    }\n    if (options.scale !== undefined) {\n      this.scale = options.scale\n    }\n    if (options.skew !== undefined) {\n      this.skew = options.skew\n    }\n  }\n\n  /**\n   * 更新优化\n   */\n  private get _renderableShouldUpdate() {\n    return !(!this.visible\n      || this.scale.x === 0\n      || this.scale.y === 0\n      || this.alpha === 0)\n  }\n  /**\n   * 更新优化\n   * 如果_shouldRender为true 则渲染\n   * 否则跳过渲染\n   */\n  abstract get _shouldUpdate(): boolean\n\n  get shouldUpdate() {\n    return this._renderableShouldUpdate && this._shouldUpdate\n  }\n\n  protected _dirty = false\n  set dirty(value) {\n    if (this._dirty === value)\n      return\n    this._dirty = value\n  }\n\n  get dirty() {\n    return this._dirty\n  }\n\n  private _alpha = 1\n\n  set alpha(value) {\n    if (this.alpha !== value) {\n      this._alpha = value\n      this._onUpdate()\n    }\n  }\n\n  get alpha() {\n    return this._alpha\n  }\n\n  private _shadow: ShadowType = { x: 0, y: 0 } as ShadowType\n\n  set shadow(value) {\n    if (value === this._shadow)\n      return\n    if (value) {\n      if (value.x === undefined)\n        value.x = 5\n      if (value.y === undefined)\n        value.y = 5\n      if (value.blur === undefined)\n        value.blur = 0\n\n      this._shadow = createProxy(value, () => {\n        this._onUpdate()\n      })\n      this._onUpdate()\n    }\n  }\n\n  get shadow(): ShadowType {\n    return this._shadow\n  }\n\n  set x(value) {\n    if (this.x !== value) {\n      this.position.x = value\n    }\n  }\n\n  get x() {\n    return this.position.x\n  }\n\n  set y(value) {\n    if (this.y !== value) {\n      this.position.y = value\n    }\n  }\n\n  get y() {\n    return this.position.y\n  }\n\n  private _position = new ObservablePoint(this, 0, 0)\n\n  set position(value: PointData) {\n    if (this.position !== value && !this.position.equals(value)) {\n      this._position.copyFrom(value)\n    }\n  }\n\n  get position(): ObservablePoint {\n    return this._position\n  }\n\n  private _anchor = defaultAnchor\n\n  set anchor(value: PointData | number) {\n    if (this._anchor === defaultAnchor) {\n      this._anchor = new ObservablePoint(this, 0, 0)\n    }\n    if (typeof value === 'number') {\n      if (this._anchor.equals({ x: value, y: value })) {\n        return\n      }\n      this._anchor.set(value)\n    }\n    else {\n      if (this._anchor.equals(value)) {\n        return\n      }\n      this._anchor.copyFrom(value)\n    }\n  }\n\n  get anchor(): ObservablePoint {\n    if (this._anchor === defaultAnchor) {\n      this._anchor = new ObservablePoint(this, 0, 0)\n    }\n    return this._anchor\n  }\n\n  private _pivot: ObservablePoint = defaultPivot\n\n  set pivot(value: PointData | number) {\n    if (this._pivot === defaultPivot) {\n      this._pivot = new ObservablePoint(this, 0, 0)\n    }\n    if (typeof value === 'number') {\n      if (this._pivot.equals({ x: value, y: value })) {\n        return\n      }\n      this._pivot.set(value)\n    }\n    else {\n      if (this._pivot.equals(value)) {\n        return\n      }\n      this._pivot.copyFrom(value)\n    }\n  }\n\n  get pivot(): ObservablePoint {\n    if (this._pivot === defaultPivot) {\n      this._pivot = new ObservablePoint(this)\n    }\n    return this._pivot\n  }\n\n  private _rotation = 0\n\n  set rotation(value) {\n    if (this.rotation !== value) {\n      this._rotation = value\n      this._onUpdate()\n    }\n  }\n\n  get rotation() {\n    return this._rotation\n  }\n\n  private _scale: ObservablePoint = defaultScale\n\n  set scale(value: PointData | number) {\n    if (this._scale === defaultScale) {\n      this._scale = new ObservablePoint(this, 1, 1)\n    }\n    if (typeof value === 'number') {\n      if (this._scale.equals({ x: value, y: value })) {\n        return\n      }\n      this._scale.set(value)\n    }\n    else {\n      if (this._scale.equals(value)) {\n        return\n      }\n      this._scale.copyFrom(value)\n    }\n  }\n\n  get scale(): ObservablePoint {\n    if (this._scale === defaultScale) {\n      this._scale = new ObservablePoint(this, 1, 1)\n    }\n    return this._scale\n  }\n\n  private _skew: ObservablePoint = defaultSkew\n\n  set skew(value: PointData) {\n    if (this._skew === defaultSkew) {\n      this._skew = new ObservablePoint(this)\n    }\n    if (this._skew.equals(value)) {\n      return\n    }\n    this._skew.copyFrom(value)\n  }\n\n  get skew(): ObservablePoint {\n    if (this._skew === defaultSkew) {\n      this._skew = new ObservablePoint(this, 0, 0)\n    }\n    return this._skew\n  }\n\n  _onUpdate(_point?: ObservablePoint | undefined) {\n    this.dirty = true\n  }\n\n  _app: App | null = null\n\n  private _visible = true\n\n  get visible() {\n    return this._visible\n  }\n\n  set visible(value) {\n    this._visible = value\n    this._onUpdate()\n  }\n\n  protected _shouldUpdateBounds = false\n\n  protected shouldUpdateBounds(type: string) {\n    if (this._shouldUpdateBounds) {\n      return\n    }\n    console.log('shouldUpdateBounds', type)\n    this._shouldUpdateBounds = true\n  }\n\n  /**\n   * 读取阴影\n   * @param ctx\n   */\n  private _readerShadow(ctx: CanvasRenderingContext2D) {\n    if ((this.shadow?.x || this.shadow?.y)\n      && (this.shadow?.blur || this.shadow?.color)) {\n      if (this.shadow.color) {\n        ctx.shadowColor = this.shadow.color\n      }\n      if (this.shadow.blur) {\n        ctx.shadowBlur = this.shadow.blur\n      }\n      if (this.shadow.x) {\n        ctx.shadowOffsetX = this.shadow.x\n      }\n      if (this.shadow.y) {\n        ctx.shadowOffsetY = this.shadow.y\n      }\n    }\n  }\n\n  public render(ctx: CanvasRenderingContext2D) {\n    if (this._shouldUpdateBounds) {\n      this.updateRawSize()\n      this._shouldUpdateBounds = false\n    }\n    if (this.alpha !== 1) {\n      ctx.globalAlpha = this.alpha\n    }\n    const dpr = this._app?.dpr ?? 1\n    const scaleX = this.scale.x * dpr\n    const scaleY = this.scale.y * dpr\n    const skewX = this.skew.x\n    const skewY = this.skew.y\n    const positionX = this.position.x * dpr\n    const positionY = this.position.y * dpr\n    const pivotX = this.pivot.x\n    const pivotY = this.pivot.y\n    const rotation = this.rotation\n\n    const cos = Math.cos(rotation)\n    const sin = Math.sin(rotation)\n\n    const anchorX = ensureBetween(this.anchor.x, 0, 1)\n    const anchorY = ensureBetween(this.anchor.y, 0, 1)\n\n    const originX = this.width * anchorX\n    const originY = this.height * anchorY\n\n    const dx = positionX - (pivotX + originX) * cos * scaleX + (pivotY + originY) * sin * scaleY\n    const dy = positionY - (pivotX + originX) * sin * scaleX - (pivotY + originY) * cos * scaleY\n\n    ctx.setTransform(\n      scaleX * cos + skewY * -sin, // a\n      scaleX * sin + skewY * cos, // b\n      skewX * cos + scaleY * -sin, // c\n      skewX * sin + scaleY * cos, // d\n      dx, // e\n      dy, // f\n    )\n    const _position = this.position.clone()\n    this.position.set(0)\n    this._readerShadow(ctx)\n    this._render(ctx)\n    this.position = _position\n    ctx.resetTransform()\n  }\n\n  _renderId = 0\n\n  protected abstract _render(ctx: CanvasRenderingContext2D): void\n\n  /**\n   * 原始尺寸\n   */\n  protected _rawSize = { width: 0, height: 0 }\n\n  get height() {\n    return this._rawSize.height\n  }\n\n  get width() {\n    return this._rawSize.width\n  }\n\n  /**\n   * 更新原始尺寸\n   */\n  protected abstract updateRawSize(): void\n  /**\n   * 更新原始尺寸\n   */\n  protected changeRawSize(width: number, height: number) {\n    if (this._rawSize.width === width && this._rawSize.height === height) {\n      return\n    }\n    this._rawSize.width = width\n    this._rawSize.height = height\n    this.emit('updateBounds', width, height)\n  }\n\n  onAdd(_app: App) {\n    this._app = _app\n    this._onUpdate()\n  }\n\n  onRemove() {\n    this._app = null\n    this._onUpdate()\n  }\n\n  addTo(app: App) {\n    app.add(this)\n    return this\n  }\n\n  destroy() {\n    this.removeAllListeners()\n  }\n}\n","import EventEmitter from 'eventemitter3'\nimport { createProxy } from '../utils'\n\nexport type InputColor = CanvasRenderingContext2D['strokeStyle']\nexport type LineDash = Iterable<number>\nexport interface StrokeInput {\n  /**\n   * 颜色\n   */\n  color?: InputColor\n  /**\n   * 宽度 同 [lineWidth](https://developer.mozilla.org/docs/Web/API/CanvasRenderingContext2D/lineWidth)\n   */\n  width?: number\n  /**\n   * [CanvasRenderingContext2D.lineDashOffset](https://developer.mozilla.org/docs/Web/API/CanvasRenderingContext2D/lineDashOffset)\n   */\n  dash?: LineDash\n}\n/**\n * 抽象样式\n */\nexport interface IAbstractStyle {\n  /**\n   * 填充颜色\n   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/CanvasRenderingContext2D/fillStyle)\n   */\n  fill: CanvasRenderingContext2D['fillStyle'] | null\n  /**\n   * 描边颜色 当仅仅指定stroke 而未指定 fill 时 只会绘制镂空文字\n   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/CanvasRenderingContext2D/strokeStyle)\n   */\n  stroke: StrokeInput\n  /**\n   * [CanvasRenderingContext2D.filter](https://developer.mozilla.org/docs/Web/API/CanvasRenderingContext2D/filter)\n   */\n  filter: CanvasRenderingContext2D['filter']\n}\nexport abstract class AbstractStyle extends EventEmitter<{\n  update: []\n  updateBounds: []\n}> implements IAbstractStyle {\n  private _fill = '#000'\n\n  set fill(value) {\n    this._fill = value\n    this.update()\n  }\n\n  get fill() {\n    return this._fill\n  }\n\n  private _stroke: StrokeInput = {}\n\n  set stroke(value: StrokeInput | InputColor) {\n    if (value === this._stroke)\n      return\n    if (\n      typeof value === 'string'\n      || (typeof CanvasGradient !== 'undefined' && value instanceof CanvasGradient)\n      || (typeof CanvasPattern !== 'undefined' && value instanceof CanvasPattern)\n    ) {\n      this._stroke = createProxy({\n        ...this._stroke,\n        color: value,\n      }, () => {\n        this.update()\n      })\n    }\n    else {\n      this._stroke = createProxy(value as StrokeInput, () => {\n        this.update()\n      })\n      this.update()\n    }\n  }\n\n  get stroke(): StrokeInput {\n    return this._stroke\n  }\n\n  private _filter = 'none'\n\n  set filter(value) {\n    this._filter = value\n    this.update()\n  }\n\n  get filter() {\n    return this._filter\n  }\n\n  update() {\n    this.emit('update')\n  }\n\n  updateBounds() {\n    this.emit('updateBounds')\n  }\n\n  render(ctx: CanvasRenderingContext2D) {\n    if (this.stroke.color && this.stroke.width) {\n      ctx.lineWidth = this.stroke.width\n      ctx.strokeStyle = this.stroke.color\n    }\n    if (this.fill) {\n      ctx.fillStyle = this.fill\n    }\n    if (this.filter) {\n      ctx.filter = this.filter\n    }\n    return this\n  }\n\n  destroy() {\n    this.removeAllListeners()\n  }\n}\n","import type { Properties } from 'csstype'\nimport { createCanvasFontString, formatWithPx } from '../utils'\nimport type { IAbstractStyle } from './abstract-style'\nimport { AbstractStyle } from './abstract-style'\n\nexport interface TextStyleOptions extends IAbstractStyle {\n  /**\n   * @description 字体大小 当值为 number 时单位为px\n   * [MDN Reference](https://developer.mozilla.org/zh-CN/docs/Web/CSS/font-size)\n   */\n  fontSize: Properties['fontSize'] | (number & {})\n  /**\n   * 文本时文本的对齐方式\n   * [MDN Reference](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/textAlign)\n   */\n  textAlign: CanvasTextAlign\n  /**\n   * @description 字体\n   * [MDN Reference](https://developer.mozilla.org/zh-CN/docs/Web/CSS/font-family)\n   */\n  fontFamily: Properties['fontFamily']\n  /**\n   * @description 字体样式\n   * [MDN Reference](https://developer.mozilla.org/zh-CN/docs/Web/CSS/font-style)\n   */\n  fontStyle: Properties['fontStyle']\n  /**\n   * @description 字体的粗细程度\n   * [MDN Reference](https://developer.mozilla.org/zh-CN/docs/Web/CSS/font-weight)\n   */\n  fontWeight: Properties['fontWeight']\n  /**\n   * 指定绘制文本时字体如何被扩展或压缩\n   * [MDN Reference](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/fontStretch)\n   */\n  fontStretch: CanvasFontStretch\n  /**\n   * 用于指定渲染文本的替代大写形式\n   * [MDN Reference](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/fontVariantCaps)\n   */\n  fontVariantCaps: CanvasFontVariantCaps\n  /**\n   * 用于指定绘制文本时字母之间的间距\n   * [MDN Reference](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/letterSpacing)\n   */\n  letterSpacing: string | number\n  /**\n   * 指定绘制文本时单词之间的间距\n   * [MDN Reference](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/wordSpacing)\n   */\n  wordSpacing: string | number\n  /**\n   * 是否开启换行\n   */\n  wordWrap: boolean\n  /**\n   * 换行宽度\n   */\n  wordWrapWidth: number\n  /**\n   * 用于指定文本的行高 仅当 `wordWrap` 为 `true` 时有效\n   */\n  lineHeight: number\n}\n\nexport class TextStyle extends AbstractStyle implements TextStyleOptions {\n  public static defaultTextStyle: TextStyleOptions = {\n    fill: 'black',\n    stroke: {\n      width: 1,\n    },\n    filter: 'none',\n    // 文本\n    fontSize: 12,\n    textAlign: 'left',\n    fontFamily: 'Arial',\n    fontStyle: 'normal',\n    fontWeight: 'normal',\n    fontStretch: 'condensed',\n    fontVariantCaps: 'normal',\n    letterSpacing: 0,\n    wordSpacing: 0,\n    wordWrap: false,\n    lineHeight: 12, // 默认为字体大小\n    wordWrapWidth: 0,\n  }\n\n  constructor(style: Partial<TextStyleOptions> = {}) {\n    super()\n    const fullStyle = Object.assign({}, TextStyle.defaultTextStyle, style)\n    for (const key in fullStyle) {\n      const thisKey = key as keyof typeof this\n      const data = fullStyle[key as keyof TextStyleOptions] as any\n      if (key === 'stroke') {\n        this[thisKey] = Object.assign({}, TextStyle.defaultTextStyle[key] as unknown as object, data)\n      }\n      else {\n        this[thisKey] = data\n      }\n    }\n  }\n\n  public reset() {\n    const defaultStyle = TextStyle.defaultTextStyle\n    for (const key in defaultStyle) {\n      this[key as keyof typeof this] = defaultStyle[key as keyof TextStyleOptions] as any\n    }\n    this.updateBounds()\n    this.update()\n  }\n\n  // set fill(value: CanvasRenderingContext2D['fillStyle'] | null) {\n  //   this._fill = value ? String(value) : 'black'\n  //   this.update()\n  // }\n\n  // get fill(): string {\n  //   return this._fill\n  // }\n\n  protected readonly textBaseline = 'top'\n\n  private _fontSize: TextStyleOptions['fontSize']\n  set fontSize(value) {\n    this._fontSize = value\n    this.updateBounds()\n    this.update()\n  }\n\n  get fontSize() {\n    return this._fontSize\n  }\n\n  private _fontFamily: TextStyleOptions['fontFamily']\n  set fontFamily(value) {\n    this._fontFamily = value\n    this.updateBounds()\n    this.update()\n  }\n\n  get fontFamily() {\n    return this._fontFamily\n  }\n\n  private _fontStyle: TextStyleOptions['fontStyle']\n\n  set fontStyle(value) {\n    this._fontStyle = value\n    this.updateBounds()\n    this.update()\n  }\n\n  get fontStyle() {\n    return this._fontStyle\n  }\n\n  private _fontWeight: TextStyleOptions['fontWeight']\n\n  set fontWeight(value) {\n    this._fontWeight = value\n    this.updateBounds()\n    this.update()\n  }\n\n  get fontWeight() {\n    return this._fontWeight\n  }\n\n  private _fontStretch: TextStyleOptions['fontStretch'] = TextStyle.defaultTextStyle.fontStretch\n\n  set fontStretch(value) {\n    this._fontStretch = value\n    this.updateBounds()\n    this.update()\n  }\n\n  get fontStretch() {\n    return this._fontStretch\n  }\n\n  private _fontVariantCaps: TextStyleOptions['fontVariantCaps'] = TextStyle.defaultTextStyle.fontVariantCaps\n\n  set fontVariantCaps(value) {\n    this._fontVariantCaps = value\n    this.updateBounds()\n    this.update()\n  }\n\n  get fontVariantCaps() {\n    return this._fontVariantCaps\n  }\n\n  private _letterSpacing: TextStyleOptions['letterSpacing'] = TextStyle.defaultTextStyle.letterSpacing\n\n  set letterSpacing(value) {\n    this._letterSpacing = value\n    this.update()\n    this.updateBounds()\n  }\n\n  get letterSpacing() {\n    return this._letterSpacing\n  }\n\n  private _wordSpacing: TextStyleOptions['wordSpacing'] = TextStyle.defaultTextStyle.wordSpacing\n\n  set wordSpacing(value) {\n    this._wordSpacing = value\n    this.update()\n    this.updateBounds()\n  }\n\n  get wordSpacing() {\n    return this._wordSpacing\n  }\n\n  private _textAlign: TextStyleOptions['textAlign'] = TextStyle.defaultTextStyle.textAlign\n\n  set textAlign(value) {\n    this._textAlign = value\n    this.update()\n  }\n\n  get textAlign() {\n    return this._textAlign\n  }\n\n  private _lineHeight = 0\n\n  set lineHeight(value) {\n    if (this.lineHeight !== value) {\n      this._lineHeight = value\n      this.update()\n      this.updateBounds()\n    }\n  }\n\n  get lineHeight() {\n    if (!this._lineHeight) {\n      this._lineHeight = typeof this.fontSize == 'number' ? this.fontSize : Number.parseInt(`${this.fontSize}`)\n    }\n    return this._lineHeight\n  }\n\n  private _wordWrap = false\n\n  set wordWrap(value) {\n    if (this.wordWrap !== value) {\n      this._wordWrap = value\n      this.update()\n      this.updateBounds()\n    }\n  }\n\n  get wordWrap() {\n    return this._wordWrap\n  }\n\n  private _wordWrapWidth = 0\n\n  set wordWrapWidth(value) {\n    if (this.wordWrapWidth !== value) {\n      this._wordWrapWidth = value\n      this.update()\n      this.updateBounds()\n    }\n  }\n\n  get wordWrapWidth() {\n    return this._wordWrapWidth\n  }\n\n  clone() {\n    return new TextStyle({\n      fill: this.fill,\n      stroke: this.stroke,\n      fontFamily: this.fontFamily,\n      fontSize: this.fontSize,\n      fontStyle: this.fontStyle,\n      fontWeight: this.fontWeight,\n      fontStretch: this.fontStretch,\n      fontVariantCaps: this.fontVariantCaps,\n      letterSpacing: this.letterSpacing,\n      wordSpacing: this.wordSpacing,\n      textAlign: this.textAlign,\n      filter: this.filter,\n    })\n  }\n\n  render(ctx: CanvasRenderingContext2D) {\n    super.render(ctx)\n    ctx.textBaseline = 'top'\n    ctx.font = createCanvasFontString(this)\n    ctx.fontStretch = this.fontStretch\n    ctx.fontVariantCaps = this.fontVariantCaps\n    ctx.letterSpacing = formatWithPx(this.letterSpacing)\n    ctx.wordSpacing = formatWithPx(this.wordSpacing)\n    ctx.textAlign = this.textAlign\n    return this\n  }\n};\n","import type { Properties } from 'csstype'\nimport type { PointData } from '../coordinate/PointData'\nimport { ObservablePoint } from '../coordinate/ObservablePoint'\nimport { ENV, calcDiff, drawRectCompatible } from '../utils'\nimport type { App } from '../app'\nimport type { RenderableOptions, ShadowType } from './renderable'\nimport { Renderable } from './renderable'\n\nexport interface PictureOptions extends RenderableOptions {\n  /**\n   *  image\n   */\n  image: HTMLImageElement | string\n  /**\n   * 图片的宽高\n   */\n  size?: PointData\n  /**\n   * 图片切片的开始坐标\n   */\n  slice?: PointData\n  /**\n   * 图片切片的宽高\n   */\n  sliceSize?: PointData\n  /**\n   * 图片的缩放模式\n   */\n  objectFit?: Properties['objectFit']\n  /**\n   * 圆角\n   */\n  rounded?: number\n  /**\n   * @deprecated 图片不支持阴影\n   */\n  shadow?: ShadowType\n}\n\nexport class Picture extends Renderable {\n  private src = ''\n  constructor(private options?: PictureOptions) {\n    super(options)\n    const maybeImage = options?.image\n    if (typeof maybeImage == 'string') {\n      if (this._env === ENV.WX) {\n        this.src = maybeImage\n      }\n      else {\n        this.image = document.createElement('img')\n        this.image.src = maybeImage\n        this.initImageEvents()\n      }\n      this.rounded = this.options?.rounded ?? 0\n    }\n    else {\n      this.image = maybeImage\n      this.initImageEvents()\n    }\n  }\n\n  onAdd(_app: App) {\n    super.onAdd(_app)\n    if (this._env !== ENV.WEB) {\n      _app.onReady(this.createImage.bind(this))\n    }\n  }\n\n  createImage() {\n    if (!this._app)\n      return\n    this.image = (this._app?.canvas as any).createImage()\n    this.image!.src = this.src\n    this.initImageEvents()\n  }\n\n  initImageEvents() {\n    if (!this.image)\n      return\n    if (this.image.complete) {\n      this._onImageComplete()\n    }\n    else {\n      this.image.addEventListener('load', () => {\n        this._onImageComplete()\n      })\n    }\n  }\n\n  private image?: HTMLImageElement\n\n  private _size = new ObservablePoint(this, 0, 0)\n\n  private _imageSize = new ObservablePoint(this, 0, 0)\n\n  set size(value: PointData) {\n    if (this.size !== value && !this.size.equals(value)) {\n      this._size.copyFrom(value)\n      this.shouldUpdateBounds('size')\n    }\n  }\n\n  get size(): ObservablePoint {\n    return this._size\n  }\n\n  private _slice = new ObservablePoint(this)\n\n  set slice(value: PointData) {\n    if (this.slice !== value) {\n      this._slice.copyFrom(value)\n      this.shouldUpdateBounds('slice')\n    }\n  }\n\n  get slice(): ObservablePoint {\n    return this._slice\n  }\n\n  private _sliceSize = new ObservablePoint(this)\n\n  set sliceSize(value: PointData) {\n    if (this.sliceSize !== value) {\n      this._sliceSize.copyFrom(value)\n      this._onUpdate()\n      this.shouldUpdateBounds('sliceSize')\n    }\n  }\n\n  get sliceSize(): ObservablePoint {\n    return this._sliceSize\n  }\n\n  private _objectFit: Properties['objectFit'] = 'none'\n\n  set objectFit(value) {\n    if (this.objectFit !== value) {\n      this._objectFit = value\n      this.shouldUpdateBounds('objectFit')\n      this._onUpdate()\n    }\n  }\n\n  get objectFit() {\n    return this._objectFit\n  }\n\n  private _rounded = 0\n\n  set rounded(value) {\n    value = value <= 0 ? 0 : value\n    if (this.rounded !== value) {\n      this._rounded = value\n      this._onUpdate()\n    }\n  }\n\n  _onUpdate(_point?: ObservablePoint | undefined) {\n    if (this._complete)\n      super._onUpdate(_point)\n  }\n\n  get rounded() {\n    return this._rounded\n  }\n\n  private _complete = false\n\n  private _onImageComplete() {\n    if (!this.image)\n      return\n    this._imageSize.set(\n      this.image.width,\n      this.image.height,\n    )\n\n    this.size = this.options?.size ?? {\n      x: this.image.width,\n      y: this.image.height,\n    }\n\n    this.slice = this.options?.slice ?? this.slice\n\n    this.sliceSize = this.options?.sliceSize ?? {\n      x: this.size.x,\n      y: this.size.y,\n    }\n\n    this.objectFit = this.options?.objectFit ?? this.objectFit\n\n    this.rounded = this.options?.rounded ?? this.rounded\n    this._complete = true\n    this._onUpdate()\n  }\n\n  get _shouldUpdate(): boolean {\n    return true\n  }\n\n  private get _isSlice() {\n    return (!!this.slice.x || !!this.slice.y) || !this.sliceSize.equals(this.size)\n  }\n\n  private renderRoundedClip(ctx: CanvasRenderingContext2D, position: PointData, size: PointData) {\n    drawRectCompatible(ctx, position, size, this.rounded)\n    ctx.clip()\n  }\n\n  protected _render(ctx: CanvasRenderingContext2D): void {\n    if (!this.image || !this._complete) {\n      return\n    }\n    if (!this._isSlice) {\n      const _size = this.size.clone()\n      const _position = this.position.clone()\n      const scaleDiff = _size.x / this._imageSize.x\n      const diffSize = calcDiff([this._imageSize.x, this._imageSize.y])\n      const diff = diffSize * scaleDiff\n      const slim = this._imageSize.x < this._imageSize.y\n      const fat = this._imageSize.x > this._imageSize.y\n      if (slim || fat) {\n        switch (this.objectFit) {\n          case 'contain':\n            if (slim) {\n              this.position.set(this.position.x - diff / 2, this.position.y)\n              this.size.set(this.size.x - diff, this.size.y)\n            }\n            else {\n              this.position.set(this.position.x, this.position.y + diff / 2)\n              this.size.set(this.size.x, this.size.y - diff)\n            }\n            this.renderRoundedClip(ctx, this.position, this.size)\n            break\n          case 'cover':\n            if (slim) {\n              this.position.set(this.position.x + diff / 2, this.position.y)\n              this.size.set(this.size.x + diff, this.size.y)\n            }\n            else {\n              this.position.set(this.position.x - diff / 2, this.position.y)\n              this.size.set(this.size.x + diff, this.size.y)\n            }\n            this.renderRoundedClip(ctx, _position, _size)\n            break\n          default:\n            this.renderRoundedClip(ctx, this.position, this.size)\n        }\n      }\n      ctx.drawImage(\n        this.image,\n        this.position.x,\n        this.position.y,\n        this.size.x,\n        this.size.y,\n      )\n      this.position = _position\n      this.size = _size\n    }\n    else {\n      const args = [\n        this.image,\n        this.slice.x,\n        this.slice.y,\n        this.sliceSize.x,\n        this.sliceSize.y,\n        this.x,\n        this.y,\n        this.size.x,\n        this.size.y,\n      ] as const\n      this.renderRoundedClip(ctx, this.position, this.size)\n      ctx.drawImage(...args)\n    }\n  }\n\n  protected updateRawSize(): void {\n    this.changeRawSize(this.size.x, this.size.y)\n  }\n}\n","import type { IAbstractStyle, InputColor, StrokeInput } from '../style/abstract-style'\n// import type { FunctionKeys } from '../types'\nimport { ENV, calcDiff, createProxy, drawRectCompatible } from '../utils'\nimport type { RenderableOptions } from './renderable'\nimport { Renderable } from './renderable'\n\n// type CanvasRenderingContext2DMethods = FunctionKeys<CanvasRenderingContext2D>\ninterface PathData<T extends keyof CanvasRenderingContext2D> {\n  action: T\n  args: any[]\n}\n\ntype Methods =\n  | 'beginPath'\n  | 'closePath'\n  | 'moveTo'\n  | 'fill'\n  | 'stroke'\n  | 'lineTo' //\n  | 'rect' //\n  | 'roundRect' //\n  | 'fillRect' //\n  | 'strokeRect'\n  | 'arc' //\n  | 'arcTo' //\n  | 'bezierCurveTo' //\n  | 'ellipse'\n  | 'lineCap'\n  | 'lineJoin'\n\ntype PathInstruction = PathData<Methods>\ninterface _ShapeOptions extends RenderableOptions { }\n\ninterface IShape {\n  beginPath: () => Shape\n  closePath: () => Shape\n  moveTo: (...args: Parameters<CanvasRenderingContext2D['moveTo']>) => Shape\n  lineTo: (...args: Parameters<CanvasRenderingContext2D['lineTo']>) => Shape\n  stroke: (value?: StrokeInput | InputColor) => Shape\n  fill: (color?: InputColor) => Shape\n  rect: (...args: Parameters<CanvasRenderingContext2D['rect']>) => Shape\n  roundRect: (...args: Parameters<CanvasRenderingContext2D['roundRect']>) => Shape\n  arc: (...args: Parameters<CanvasRenderingContext2D['arc']>) => Shape\n  arcTo: (...args: Parameters<CanvasRenderingContext2D['arcTo']>) => Shape\n  bezierCurveTo: (...args: Parameters<CanvasRenderingContext2D['bezierCurveTo']>) => Shape\n  ellipse: (...args: Parameters<CanvasRenderingContext2D['ellipse']>) => Shape\n  fillRect: (...args: Parameters<CanvasRect['fillRect']>) => Shape\n  strokeRect: (...args: Parameters<CanvasRect['strokeRect']>) => Shape\n  lineCap: (...args: [CanvasRenderingContext2D['lineCap']]) => void\n  lineJoin: (...args: [CanvasRenderingContext2D['lineJoin']]) => void\n}\n\nexport type ShapeOptions = Partial<_ShapeOptions>\n\nexport class Shape extends Renderable implements IShape {\n  constructor(options: ShapeOptions = {}) {\n    super(options)\n    this._onUpdate()\n  }\n\n  private addPath(...items: PathInstruction[]) {\n    this.pathInstruction.push(...items)\n    this.shouldUpdateBounds('path')\n  }\n\n  beginPath(): Shape {\n    this.addPath({\n      action: 'beginPath',\n      args: [],\n    })\n    return this\n  }\n\n  closePath() {\n    this.addPath({\n      action: 'closePath',\n      args: [],\n    })\n    return this\n  }\n\n  lineCap(cap: 'butt' | 'round' | 'square') {\n    this.addPath({\n      action: 'lineCap',\n      args: [cap],\n    })\n    return this\n  }\n\n  lineJoin(join: 'bevel' | 'miter' | 'round') {\n    this.addPath({\n      action: 'lineJoin',\n      args: [join],\n    })\n    return this\n  }\n\n  moveTo(x: number, y: number) {\n    this.addPath({\n      action: 'moveTo',\n      args: [x, y],\n    })\n    return this\n  }\n\n  lineTo(x: number, y: number) {\n    this.addPath({\n      action: 'lineTo',\n      args: [x, y],\n    })\n    return this\n  }\n\n  rect(x: number, y: number, w: number, h: number) {\n    this.addPath({\n      action: 'rect',\n      args: [x, y, w, h],\n    })\n    return this\n  }\n\n  roundRect(\n    x: number,\n    y: number,\n    w: number,\n    h: number,\n    radii?: number | DOMPointInit | Iterable<number | DOMPointInit>,\n  ) {\n    this.addPath({\n      action: 'roundRect',\n      args: [x, y, w, h, radii],\n    })\n    return this\n  }\n\n  arc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number = 0,\n    endAngle: number = 2 * Math.PI,\n    counterclockwise?: boolean,\n  ) {\n    this.addPath({\n      action: 'arc',\n      args: [x, y, radius, startAngle, endAngle, counterclockwise],\n    })\n    return this\n  }\n\n  arcTo(x1: number, y1: number, x2: number, y2: number, radius: number) {\n    this.addPath({\n      action: 'arcTo',\n      args: [x1, y1, x2, y2, radius],\n    })\n    return this\n  }\n\n  bezierCurveTo(\n    cp1x: number,\n    cp1y: number,\n    cp2x: number,\n    cp2y: number,\n    x: number,\n    y: number,\n  ) {\n    this.addPath({\n      action: 'bezierCurveTo',\n      args: [cp1x, cp1y, cp2x, cp2y, x, y],\n    })\n    return this\n  }\n\n  ellipse(\n    x: number,\n    y: number,\n    radiusX: number,\n    radiusY: number,\n    rotation: number,\n    startAngle: number,\n    endAngle: number,\n    counterclockwise?: boolean,\n  ) {\n    this.addPath({\n      action: 'ellipse',\n      args: [x, y, radiusX, radiusY, rotation, startAngle, endAngle, counterclockwise],\n    })\n    return this\n  }\n\n  fillRect(x: number, y: number, w: number, h: number) {\n    this.addPath({\n      action: 'fillRect',\n      args: [x, y, w, h],\n    })\n    return this\n  }\n\n  strokeRect(x: number, y: number, w: number, h: number) {\n    this.addPath({\n      action: 'strokeRect',\n      args: [x, y, w, h],\n    })\n    return this\n  }\n\n  private pathInstruction: PathInstruction[] = []\n  get _shouldUpdate(): boolean {\n    const actions = this.pathInstruction.map(item => item.action)\n    if (actions.includes('fill')\n      || actions.includes('stroke')) {\n      return true\n    }\n    return false\n  }\n\n  protected _render(ctx: CanvasRenderingContext2D): void {\n    if (!ctx) {\n      throw new Error('CanvasRenderingContext2D is null or undefined')\n    }\n    for (let index = 0; index < this.pathInstruction.length; index++) {\n      const { action, args } = this.pathInstruction[index]\n      if (action === 'fill') {\n        if (args[0]) {\n          ctx.fillStyle = args[0]\n        }\n        else if (this.fillStyle) {\n          ctx.fillStyle = this.fillStyle\n        }\n        ctx.fill()\n      }\n      else if (action === 'stroke') {\n        if (args[0]) {\n          const strokeInput = args[0] as StrokeInput | InputColor\n          if (typeof strokeInput === 'string'\n            || (typeof CanvasGradient !== 'undefined' && strokeInput instanceof CanvasGradient)\n            || (typeof CanvasPattern !== 'undefined' && strokeInput instanceof CanvasPattern)\n          ) {\n            ctx.strokeStyle = strokeInput\n            ctx.lineWidth = this.strokeStyle.width ?? 1\n          }\n          else {\n            const _strokeInput = strokeInput as StrokeInput\n            const color = _strokeInput.color ?? this.strokeStyle.color\n            if (color)\n              ctx.strokeStyle = color\n\n            const width = _strokeInput.width ?? this.strokeStyle.width\n\n            if (width)\n              ctx.lineWidth = width\n\n            if (_strokeInput.dash) {\n              ctx.setLineDash(_strokeInput.dash)\n            }\n            else {\n              ctx.setLineDash([])\n            }\n          }\n        }\n        else {\n          if (this.strokeStyle.color)\n            ctx.strokeStyle = this.strokeStyle.color\n          if (this.strokeStyle.width)\n            ctx.lineWidth = this.strokeStyle.width\n          if (this.strokeStyle.dash) {\n            ctx.setLineDash(this.strokeStyle.dash)\n          }\n          else {\n            ctx.setLineDash([])\n          }\n        }\n        ctx.stroke()\n      }\n      else if (['lineCap', 'lineJoin'].includes(action)) {\n        ctx[action] = args[0]\n      }\n      else if (action === 'roundRect' && this._env === ENV.WX) {\n        drawRectCompatible(ctx, { x: args[0], y: args[1] }, { x: args[2], y: args[3] }, args[4])\n      }\n      else {\n        if (!(action in ctx)) {\n          throw new Error(`CanvasRenderingContext2D has no method ${action}`)\n        }\n        else {\n          ;(ctx[action] as (...args: any[]) => void)(...args)\n        }\n      }\n    }\n  }\n\n  private _strokeStyle: StrokeInput = {}\n\n  set strokeStyle(value: StrokeInput | InputColor) {\n    if (value === this._strokeStyle)\n      return\n    if (\n      typeof value === 'string'\n      || (typeof CanvasGradient !== 'undefined' && value instanceof CanvasGradient)\n      || (typeof CanvasPattern !== 'undefined' && value instanceof CanvasPattern)\n    ) {\n      this._strokeStyle = createProxy({\n        ...this._strokeStyle,\n        color: value,\n      }, () => {\n        this._onUpdate()\n      })\n    }\n    else {\n      this._strokeStyle = createProxy(value as StrokeInput, () => {\n        this._onUpdate()\n      })\n      this._onUpdate()\n    }\n  }\n\n  get strokeStyle(): StrokeInput {\n    return this._strokeStyle\n  }\n\n  protected updateRawSize(): void {\n    const allX: number[] = []\n    const allY: number[] = []\n\n    for (let index = 0; index < this.pathInstruction.length; index++) {\n      const { action, args } = this.pathInstruction[index]\n      switch (action) {\n        case 'lineTo':\n\n          allX.push(args[0])\n          allY.push(args[1])\n          break\n        case 'fillRect':\n        case 'strokeRect':\n        case 'roundRect':\n        case 'rect':{\n          // const strokeWeight = this.getNextStrokeWidth(index)\n          allX.push(args[0])\n          allY.push(args[1])\n          allX.push(args[0] + args[2])\n          allY.push(args[1] + args[3])\n          break\n        }\n        case 'arc':{\n          allX.push(args[0] + args[2])\n          allY.push(args[1] + args[2])\n          break\n        }\n        case 'arcTo':{\n          allX.push(args[0] + args[2])\n          allY.push(args[1] + args[2])\n          break\n        }\n        case 'bezierCurveTo': {\n          allX.push(args[2] + args[4])\n          allY.push(args[3] + args[5])\n          break\n        }\n        case 'ellipse':\n          allX.push(args[0] + args[2])\n          allY.push(args[1] + args[3])\n      }\n    }\n    const w = calcDiff(allX)\n    const h = calcDiff(allY)\n    this.changeRawSize(w, h)\n  }\n\n  private _fillStyle: InputColor | null = null\n\n  set fillStyle(value) {\n    this._fillStyle = value\n    this._onUpdate()\n  }\n\n  get fillStyle() {\n    return this._fillStyle\n  }\n\n  fill(color?: IAbstractStyle['fill']) {\n    if (color) {\n      this.addPath({\n        action: 'fill',\n        args: [color],\n      })\n    }\n    return this\n  }\n\n  stroke(value?: StrokeInput | InputColor) {\n    this.addPath({\n      action: 'stroke',\n      args: value ? [value] : [],\n    })\n    return this\n  }\n\n  private _filter = 'none'\n\n  set filter(value) {\n    this._filter = value\n    this._onUpdate()\n  }\n\n  get filter() {\n    return this._filter\n  }\n}\n","import type { TextStyleOptions } from '../style/text-style'\nimport { TextStyle } from '../style/text-style'\nimport type { RenderableOptions } from './renderable'\nimport { Renderable } from './renderable'\n\nexport interface TextOptions extends RenderableOptions {\n  /**\n   * 文本\n   */\n  text: string\n  /**\n   * 文本样式\n   */\n  style?: Partial<TextStyleOptions> | TextStyle\n}\n\nexport class Text extends Renderable {\n  constructor(options: TextOptions) {\n    super(options)\n    if (options.style)\n      this.style = options.style\n    this.text = options.text ?? ''\n    this._onUpdate()\n  }\n\n  private _style = new TextStyle()\n\n  set style(style: Partial<TextStyleOptions> | TextStyle) {\n    style = style || {}\n    this._style?.off('update', this._onUpdate, this)\n    this._style?.off('updateBounds', this.shouldUpdateBounds.bind(this, 'style'), this)\n    if (style instanceof TextStyle) {\n      this._style = style\n    }\n    else {\n      this._style = new TextStyle(style)\n    }\n    this._style.on('update', this._onUpdate, this)\n    this._style?.on('updateBounds', this.shouldUpdateBounds.bind(this, 'style'), this)\n    this.shouldUpdateBounds('any')\n    this._onUpdate()\n  }\n\n  get style(): TextStyle {\n    return this._style\n  }\n\n  private _text = ''\n\n  set text(text) {\n    if (this._text === text)\n      return\n    this._text = text\n    this._onUpdate()\n  }\n\n  get text() {\n    return this._text\n  }\n\n  get _shouldUpdate(): boolean {\n    return !!(this.style.fill) || !!(this.style.stroke.color && this.style.stroke.width)\n  }\n\n  getSplitText(ctx: CanvasRenderingContext2D) {\n    const texts = this.text.split('')\n    const splitText = []\n    let multilineText: string[] = []\n    for (let i = 0; i < texts.length; i++) {\n      const currentStr = texts[i]\n      multilineText.push(currentStr)\n      const rowStr = multilineText.join('')\n      if (ctx.measureText(rowStr).width > this.style.wordWrapWidth) {\n        multilineText.pop()\n        splitText.push(multilineText.join(''))\n        multilineText = [currentStr]\n        continue\n      }\n      if (i === texts.length - 1) {\n        splitText.push(rowStr)\n      }\n    }\n    return splitText\n  }\n\n  _render(ctx: CanvasRenderingContext2D) {\n    if (this.style.fill || (this.style.stroke?.color && this.style.stroke?.width)) {\n      this.style.render(ctx)\n      // 绘制单行文本\n      if (!this.style.wordWrap || !this.style.wordWrapWidth) {\n        if (this.style.stroke?.color && this.style.stroke?.width) {\n          ctx.strokeText(this.text, this.position.x, this.position.y)\n        }\n        if (this.style.fill) {\n          ctx.fillText(this.text, this.position.x, this.position.y)\n        }\n      }\n      else {\n        const splitText = this.getSplitText(ctx)\n        for (let i = 0; i < splitText.length; i++) {\n          const text = splitText[i]\n          if (this.style.fill) {\n            ctx.fillText(text, this.position.x, this.position.y + i * this.style.lineHeight)\n          }\n          if (this.style.stroke?.color && this.style.stroke?.width) {\n            ctx.strokeText(text, this.position.x, this.position.y + i * this.style.lineHeight)\n          }\n        }\n      }\n    }\n  }\n\n  protected updateRawSize() {\n    if (!this._app) {\n      return\n    }\n    this._app.wrapperRender((ctx) => {\n      this.style.render(ctx)\n      let rawWidth = this._rawSize.width\n      let rawHeight = this._rawSize.height\n      if (!this.style.wordWrap || !this.style.wordWrapWidth) {\n        const measure = ctx.measureText(this.text)\n        rawWidth = measure.width\n        let height = Math.max(...[\n          measure.actualBoundingBoxDescent - measure.actualBoundingBoxAscent,\n          typeof this.style.fontSize == 'number' ? this.style.fontSize : Number.parseInt(`${this.style.fontSize}`),\n        ])\n        if (this.style.stroke && this.style.stroke.width) {\n          height += this.style.stroke.width\n        }\n        rawHeight = height\n      }\n      else {\n        const splitText = this.getSplitText(ctx)\n        rawWidth = this.style.wordWrapWidth\n        if (!splitText.length) {\n          rawHeight = 0\n          return\n        }\n        const measure = ctx.measureText(this.getSplitText(ctx)[0])\n        const lineHeight = this.style.lineHeight\n        let height = Math.max(...[\n          measure.actualBoundingBoxDescent - measure.actualBoundingBoxAscent,\n          lineHeight,\n        ])\n        if (this.style.stroke && this.style.stroke.width) {\n          height += this.style.stroke.width\n        }\n        if (splitText.length > 1) {\n          rawHeight = (splitText.length - 1) * lineHeight + height\n        }\n      }\n      this.changeRawSize(rawWidth, rawHeight)\n    })\n  }\n};\n"],"names":["has","Object","prototype","hasOwnProperty","prefix","Events","EE","fn","context","once","this","addListener","emitter","event","TypeError","listener","evt","_events","push","_eventsCount","clearEvent","EventEmitter","create","__proto__","eventNames","events","name","names","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","length","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","module","exports","ENV","formatWithPx","val","calcDiff","numbers","reduce","a","b","calcMax","calcMin","ensureBetween","input","min","max","createProxy","value","cb","Proxy","set","target","property","newValue","getEnv","uni","UNI_APP","wx","WX","window","document","WEB","UNKNOWN","drawRectCompatible","ctx","position","size","rounded","Math","x","y","beginPath","moveTo","arcTo","closePath","roundRect","rect","Ticker","autoStart","requestAnimationFrame","cancelAnimationFrame","myReq","isRunning","handler","_env","constructor","init","canvas","bind","start","add","removeAll","remove","index","indexOf","splice","update","stop","forEach","performance","now","ObservablePoint","_x","_y","_observer","observer","clone","_onUpdate","copyFrom","p","copyTo","equals","Symbol","iterator","step","properties","next","done","defaultSkew","defaultPivot","defaultAnchor","defaultScale","Renderable","options","super","visible","alpha","shadow","anchor","pivot","rotation","scale","skew","_renderableShouldUpdate","shouldUpdate","_shouldUpdate","_dirty","dirty","_alpha","_shadow","blur","_position","_anchor","_pivot","_rotation","_scale","_skew","_point","_app","_visible","_shouldUpdateBounds","shouldUpdateBounds","type","console","log","_readerShadow","color","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","render","updateRawSize","globalAlpha","dpr","scaleX","scaleY","skewX","skewY","positionX","positionY","pivotX","pivotY","cos","sin","anchorX","anchorY","originX","width","originY","height","dx","dy","setTransform","_render","resetTransform","_renderId","_rawSize","changeRawSize","onAdd","onRemove","addTo","app","destroy","AbstractStyle","_fill","fill","_stroke","stroke","CanvasGradient","CanvasPattern","_filter","filter","updateBounds","lineWidth","strokeStyle","fillStyle","TextStyle","static","fontSize","textAlign","fontFamily","fontStyle","fontWeight","fontStretch","fontVariantCaps","letterSpacing","wordSpacing","wordWrap","lineHeight","wordWrapWidth","style","fullStyle","assign","defaultTextStyle","key","thisKey","data","reset","defaultStyle","textBaseline","_fontSize","_fontFamily","_fontStyle","_fontWeight","_fontStretch","_fontVariantCaps","_letterSpacing","_wordSpacing","_textAlign","_lineHeight","Number","parseInt","_wordWrap","_wordWrapWidth","font","createCanvasFontString","_ready","ticker","_width","_height","removeResizeEvent","validateAppOptions","initDpr","initTicker","initCanvas","onReady","appOptions","error","devicePixelRatio","querySelector","query","createSelectorQuery","select","fields","node","exec","res","initCanvasRenderingContext2D","createElement","resizeTo","backgroundColor","initResizeEvent","getContext","Window","resizeHandler","innerWidth","innerHeight","_resizeHandler","addEventListener","removeEventListener","clientWidth","clientHeight","resizeObserver","ResizeObserver","observe","disconnect","shouldResize","resize","beforeRender","save","afterRender","restore","children","objects","object","delIndex","e","clearRect","shouldRender","child","shift","toDataURL","quality","toDataURLAsync","Promise","resolve","wrapperRender","src","maybeImage","image","initImageEvents","createImage","complete","_onImageComplete","_size","_imageSize","_slice","_sliceSize","sliceSize","_objectFit","objectFit","_rounded","_complete","_isSlice","renderRoundedClip","clip","drawImage","scaleDiff","diff","slim","fat","addPath","items","pathInstruction","action","lineCap","cap","lineJoin","join","lineTo","w","h","radii","arc","radius","startAngle","endAngle","PI","counterclockwise","x1","y1","x2","y2","bezierCurveTo","cp1x","cp1y","cp2x","cp2y","ellipse","radiusX","radiusY","fillRect","strokeRect","actions","map","item","includes","Error","strokeInput","_strokeInput","dash","setLineDash","_strokeStyle","allX","allY","_fillStyle","text","_style","_text","getSplitText","texts","split","splitText","multilineText","currentStr","rowStr","measureText","pop","fillText","strokeText","rawWidth","rawHeight","measure","actualBoundingBoxDescent","actualBoundingBoxAscent"],"mappings":"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","x_google_ignoreList":[0]}