"use strict";var t=require("../index-DdxX_nW5.js"),s=require("../coordinate/ObservablePoint.js"),i=require("../utils.js");const e=new s.ObservablePoint(null),o=new s.ObservablePoint(null),h=new s.ObservablePoint(null),a=new s.ObservablePoint(null,1,1);class n extends t.EventEmitter{constructor(t={}){super(),this.visible=t.visible??!0,t.position?this.position=t.position:(this.x=t.x??0,this.y=t.y??0),t.scale&&(this.scale=t.scale),t.skew&&(this.skew=t.skew),t.pivot&&(this.pivot=t.pivot),t.shadow&&(this.shadow=t.shadow),t.anchor&&(this.anchor=t.anchor),t.rotation&&(this.rotation=t.rotation)}get __shouldUpdate(){return!(!this.visible||0===this.scale.x||0===this.scale.y||0===this.alpha)}get shouldUpdate(){return this.__shouldUpdate&&this._shouldUpdate}_dirty=!1;set dirty(t){this._dirty!==t&&(this._dirty=t)}get dirty(){return this._dirty}set x(t){this.x!==t&&(this.position.x=t)}get x(){return this.position.x}set y(t){this.y!==t&&(this.position.y=t)}get y(){return this.position.y}_position=new s.ObservablePoint(this,0,0);set position(t){this.position!==t&&this._position.copyFrom(t)}get position(){return this._position}_scale=a;set scale(t){this._scale===a&&(this._scale=new s.ObservablePoint(this,1,1)),"number"==typeof t?this._scale.set(t):this._scale.copyFrom(t)}get scale(){return this._scale===a&&(this._scale=new s.ObservablePoint(this,1,1)),this._scale}_skew=e;set skew(t){this._skew===e&&(this._skew=new s.ObservablePoint(this)),this._skew.copyFrom(t)}get skew(){return this._skew===e&&(this._skew=new s.ObservablePoint(this,0,0)),this._skew}_alpha=1;set alpha(t){this.alpha!==t&&(this._alpha=t,this._onUpdate())}get alpha(){return this._alpha}_rotation=0;set rotation(t){this.rotation!==t&&(this._rotation=t,this._onUpdate())}get rotation(){return this._rotation}_anchor=h;set anchor(t){this._anchor===h&&(this._anchor=new s.ObservablePoint(this,0,0)),"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get anchor(){return this._anchor===h&&(this._anchor=new s.ObservablePoint(this)),this._anchor}_pivot=o;set pivot(t){this._pivot===o&&(this._pivot=new s.ObservablePoint(this,0,0)),"number"==typeof t?this._pivot.set(t):this._pivot.copyFrom(t)}get pivot(){return this._pivot===o&&(this._pivot=new s.ObservablePoint(this)),this._pivot}_shadow={x:0,y:0};set shadow(t){t!==this._shadow&&t&&(this._shadow=i.createProxy(t,(()=>{this._onUpdate()})),this._onUpdate())}get shadow(){return this._shadow}_onUpdate(t){this.dirty=!0}_app=null;_visible=!0;get visible(){return this._visible}set visible(t){this._visible=t,this._onUpdate()}_shouldUpdateBounds=!0;shouldUpdateBounds(){this._shouldUpdateBounds=!0}_baseRender(t){(this.shadow?.x||this.shadow?.y)&&(this.shadow?.blur||this.shadow?.color)&&(this.shadow.color&&(t.shadowColor=this.shadow.color),this.shadow.blur&&(t.shadowBlur=this.shadow.blur),this.shadow.x&&(t.shadowOffsetX=this.shadow.x),this.shadow.y&&(t.shadowOffsetY=this.shadow.y))}render(t){this._shouldUpdateBounds&&(this.updateTransformBounds(),this._shouldUpdateBounds=!1),1!==this.alpha&&(t.globalAlpha=this.alpha);const s=this._app?.dpr??1,e=this.scale.x*s,o=this.scale.y*s,h=this.skew.x,a=this.skew.y,n=this.position.x*s,r=this.position.y*s,l=this.pivot.x,p=this.pivot.y,d=this.rotation,_=Math.cos(d),w=Math.sin(d),u=i.ensureBetween(this.anchor.x,0,1),c=i.ensureBetween(this.anchor.y,0,1),b=this.transformWidth*u,v=this.transformHeight*c,y=n-(l+b)*_*e+(p+v)*w*o,x=r-(l+b)*w*e-(p+v)*_*o;t.setTransform(e*_+a*-w,e*w+a*_,h*_+o*-w,h*w+o*_,y,x);const U=this.position.clone();this.position.set(0),this._baseRender(t),this._render(t),this.position=U,t.resetTransform()}_renderId=0;onAdd(t){this._app=t,this._onUpdate()}onRemove(){this._app=null,this._onUpdate()}destroy(){this.removeAllListeners()}}exports.Display=n;
//# sourceMappingURL=display.js.map
