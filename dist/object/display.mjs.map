{"version":3,"file":"display.mjs","sources":["../../src/object/display.ts"],"sourcesContent":["import { Event } from '../common/event'\nimport type {\n  MaybePoint,\n} from '../position/point'\nimport {\n  Point,\n} from '../position/point'\nimport type { RenderImpl } from '../types'\n\n/**\n * [单位矩阵变化](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/setTransform)\n */\nexport interface DisplayImpl {\n\n  angle?: number\n\n  scale?: MaybePoint\n\n  skew?: MaybePoint\n\n  anchor?: MaybePoint\n}\n\nexport abstract class Display extends Event<{ shouldUpdate: any }> implements Required<DisplayImpl> {\n  constructor() {\n    super()\n    console.log('on')\n    this.on('shouldUpdate', () => {\n      if (!this._shouldUpdate)\n        this._shouldUpdate = true\n    })\n    this.position.on('shouldUpdate', () => {\n      if (!this._shouldUpdate)\n        this._shouldUpdate = true\n    })\n  }\n\n  private _angle = 0\n  _shouldUpdate = false\n\n  get angle() {\n    return this._angle\n  }\n\n  set angle(value) {\n    this._angle = value\n  }\n\n  get x() {\n    return this.position.x\n  }\n\n  set x(val) {\n    this.position.x = val\n  }\n\n  get y() {\n    return this.position.y\n  }\n\n  set y(val) {\n    this.position.y = val\n  }\n\n  position = new Point([-Infinity, -Infinity])\n  skew = new Point([0, 0])\n  anchor = new Point([0, 0])\n  scale = new Point([1, 1])\n\n  onAdd() {\n    this._shouldUpdate = true\n  }\n\n  onRemove() {\n    this._shouldUpdate = true\n  }\n\n  abstract _render(ctx: CanvasRenderingContext2D): void\n\n  render(ctx: CanvasRenderingContext2D): void {\n    this._render(ctx)\n  }\n}\n"],"names":[],"mappings":";;;;;AAuBM,MAAgB,OAAQ,SAAQ,KAA4B,CAAA;AAChE,IAAA,WAAA,GAAA;AACE,QAAA,KAAK,EAAE,CAAA;AACP,QAAA,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;AACjB,QAAA,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,MAAK;YAC3B,IAAI,CAAC,IAAI,CAAC,aAAa;AACrB,gBAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;AAC7B,SAAC,CAAC,CAAA;QACF,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,cAAc,EAAE,MAAK;YACpC,IAAI,CAAC,IAAI,CAAC,aAAa;AACrB,gBAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;AAC7B,SAAC,CAAC,CAAA;KACH;IAEO,MAAM,GAAG,CAAC,CAAA;IAClB,aAAa,GAAG,KAAK,CAAA;AAErB,IAAA,IAAI,KAAK,GAAA;QACP,OAAO,IAAI,CAAC,MAAM,CAAA;KACnB;IAED,IAAI,KAAK,CAAC,KAAK,EAAA;AACb,QAAA,IAAI,CAAC,MAAM,GAAG,KAAK,CAAA;KACpB;AAED,IAAA,IAAI,CAAC,GAAA;AACH,QAAA,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAA;KACvB;IAED,IAAI,CAAC,CAAC,GAAG,EAAA;AACP,QAAA,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,GAAG,CAAA;KACtB;AAED,IAAA,IAAI,CAAC,GAAA;AACH,QAAA,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAA;KACvB;IAED,IAAI,CAAC,CAAC,GAAG,EAAA;AACP,QAAA,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,GAAG,CAAA;KACtB;AAED,IAAA,QAAQ,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAA;IAC5C,IAAI,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;IACxB,MAAM,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;IAC1B,KAAK,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;IAEzB,KAAK,GAAA;AACH,QAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;KAC1B;IAED,QAAQ,GAAA;AACN,QAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;KAC1B;AAID,IAAA,MAAM,CAAC,GAA6B,EAAA;AAClC,QAAA,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;KAClB;AACF;;;;"}