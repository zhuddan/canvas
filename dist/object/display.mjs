import{E as t}from"../index-Bbw8-MRv.js";import{ObservablePoint as s}from"../coordinate/ObservablePoint.mjs";import{createProxy as i,ensureBetween as h}from"../utils.mjs";const o=new s(null),e=new s(null),a=new s(null),n=new s(null,1,1);class r extends t{constructor(t={}){super(),this.visible=t.visible??!0,t.position?this.position=t.position:(this.x=t.x??0,this.y=t.y??0),t.scale&&(this.scale=t.scale),t.skew&&(this.skew=t.skew),t.pivot&&(this.pivot=t.pivot),t.shadow&&(this.shadow=t.shadow),t.anchor&&(this.anchor=t.anchor),t.rotation&&(this.rotation=t.rotation)}get __shouldUpdate(){return!(!this.visible||0===this.scale.x||0===this.scale.y||0===this.alpha)}get shouldUpdate(){return this.__shouldUpdate&&this._shouldUpdate}_dirty=!1;set dirty(t){this._dirty!==t&&(this._dirty=t)}get dirty(){return this._dirty}set x(t){this.x!==t&&(this.position.x=t)}get x(){return this.position.x}set y(t){this.y!==t&&(this.position.y=t)}get y(){return this.position.y}_position=new s(this,0,0);set position(t){this.position!==t&&this._position.copyFrom(t)}get position(){return this._position}_scale=n;set scale(t){this._scale===n&&(this._scale=new s(this,1,1)),"number"==typeof t?this._scale.set(t):this._scale.copyFrom(t)}get scale(){return this._scale===n&&(this._scale=new s(this,1,1)),this._scale}_skew=o;set skew(t){this._skew===o&&(this._skew=new s(this)),this._skew.copyFrom(t)}get skew(){return this._skew===o&&(this._skew=new s(this,0,0)),this._skew}_alpha=1;set alpha(t){this.alpha!==t&&(this._alpha=t,this._onUpdate())}get alpha(){return this._alpha}_rotation=0;set rotation(t){this.rotation!==t&&(this._rotation=t,this._onUpdate())}get rotation(){return this._rotation}_anchor=a;set anchor(t){this._anchor===a&&(this._anchor=new s(this,0,0)),"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get anchor(){return this._anchor===a&&(this._anchor=new s(this)),this._anchor}_pivot=e;set pivot(t){this._pivot===e&&(this._pivot=new s(this,0,0)),"number"==typeof t?this._pivot.set(t):this._pivot.copyFrom(t)}get pivot(){return this._pivot===e&&(this._pivot=new s(this)),this._pivot}_shadow={x:0,y:0};set shadow(t){t!==this._shadow&&t&&(this._shadow=i(t,(()=>{this._onUpdate()})),this._onUpdate())}get shadow(){return this._shadow}_onUpdate(t){this.dirty=!0}_app=null;_visible=!0;get visible(){return this._visible}set visible(t){this._visible=t,this._onUpdate()}_shouldUpdateBounds=!0;shouldUpdateBounds(){this._shouldUpdateBounds=!0}_baseRender(t){(this.shadow?.x||this.shadow?.y)&&(this.shadow?.blur||this.shadow?.color)&&(this.shadow.color&&(t.shadowColor=this.shadow.color),this.shadow.blur&&(t.shadowBlur=this.shadow.blur),this.shadow.x&&(t.shadowOffsetX=this.shadow.x),this.shadow.y&&(t.shadowOffsetY=this.shadow.y))}render(t){this._shouldUpdateBounds&&(this.updateTransformBounds(),this._shouldUpdateBounds=!1),1!==this.alpha&&(t.globalAlpha=this.alpha);const s=this._app?.dpr??1,i=this.scale.x*s,o=this.scale.y*s,e=this.skew.x,a=this.skew.y,n=this.position.x*s,r=this.position.y*s,p=this.pivot.x,d=this.pivot.y,_=this.rotation,l=Math.cos(_),w=Math.sin(_),c=h(this.anchor.x,0,1),u=h(this.anchor.y,0,1),y=this.transformWidth*c,v=this.transformHeight*u,m=n-(p+y)*l*i+(d+v)*w*o,x=r-(p+y)*w*i-(d+v)*l*o;t.setTransform(i*l+a*-w,i*w+a*l,e*l+o*-w,e*w+o*l,m,x);const b=this.position.clone();this.position.set(0),this._baseRender(t),this._render(t),this.position=b,t.resetTransform()}_renderId=0;onAdd(t){this._app=t,this._onUpdate()}onRemove(){this._app=null,this._onUpdate()}destroy(){this.removeAllListeners()}}export{r as Display};
//# sourceMappingURL=display.mjs.map
