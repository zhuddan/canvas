"use strict";var t;Object.defineProperty(exports,"__esModule",{value:!0}),function(t){t.WEB="WEB",t.UNI_APP="UNI_APP",t.WX="WX"}(t||(t={}));class e{defaultTextStyle;canvas;ctx;constructor(t={textBaseline:"top",fontFamily:'"Microsoft YaHei"',textAlign:"left"}){this.defaultTextStyle=t}init(e,n){switch(function(){if("object"==typeof uni)return t.UNI_APP;if(/MicroMessenger/.test(navigator.userAgent))return t.WX;return t.WEB}()){case t.WEB:this.canvas=new OffscreenCanvas(e,n),this.ctx=this.canvas.getContext("2d");break;case t.UNI_APP:this.canvas=uni.createOffscreenCanvas(e,n),this.ctx=this.canvas.getContext("2d");break;case t.WX:this.canvas=wx.createOffscreenCanvas(e,n),this.ctx=this.canvas.getContext("2d")}}checkCtx(){if(!this.ctx)throw new Error("请先执行 init() 函数");return!0}text(t,e,n,i={}){if(!this.checkCtx())return;const s=Object.assign({},this.defaultTextStyle,i),a=this.ctx;if(s.color&&(a.fillStyle=s.color),s.textAlign&&(a.textAlign=s.textAlign),s.font)a.font=s.font;else{const t=s?.fontSize?`${s.fontSize}px`:"32px",e=s?.fontWeight||"normal";a.font=`${t} ${e} ${s.fontFamily}`}if(s?.maxWidth&&s?.lineHeight){const i=t.split(""),o=[];let c=[];for(let t=0;t<i.length;t++){const e=i[t];c.push(e);const n=c.join("");a.measureText(n).width>s.maxWidth?(c.pop(),o.push(c.join("")),c=[e]):t===i.length-1&&o.push(n)}for(let t=0;t<o.length;t++)a.fillText(o[t],e,n+t*s.lineHeight)}else a.fillText(t,e,n)}}exports.Painter=e,exports.default=e;
