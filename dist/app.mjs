import{NOOP as t}from"./const.mjs";import{formatValue as e}from"./utils.mjs";class i{canvas;ctx;dpr=1;width;height;onUpdate;constructor({width:i=600,height:h=800,dpr:s=!0,onUpdate:d}={}){s&&(this.dpr=window.devicePixelRatio??1),this.onUpdate=d??t,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.style.width=e(i),this.canvas.style.height=e(h),this.canvas.width=i*this.dpr,this.canvas.height=h*this.dpr,this.ctx.scale(this.dpr,this.dpr),this.width=i,this.height=h,this.debug(),this.update()}beforeRender(){this.ctx.save()}afterRender(){this.ctx.restore()}debug(){const t=this.ctx;this.ctx.strokeStyle="#00ffcc",this.beforeRender(),t.textBaseline="top",t.font="12px 黑体";for(let e=0;e<Math.ceil((this.width+1)/100);e++)for(let i=0;i<Math.ceil((this.height+1)/100);i++)t.beginPath(),t.fillText(`${100*e},${100*i}`,100*e,100*i),0!==e&&0!==i&&(t.moveTo(100*e-100,100*i),t.lineTo(100*e,100*i),t.lineTo(100*e,100*i-100),t.stroke());this.afterRender()}children=[];add(t){console.log(t),t.onAdd(),this.children.push(t)}remove(t){const e=this.children.indexOf(t);-1!==e&&this.children.splice(e,1)}update(){window.requestAnimationFrame((()=>{this.update()})),this.ctx.clearRect(-this.width,-this.height,2*this.width,2*this.height),this.debug();const t=[...this.children.filter((t=>t.visible))];for(;t.length;)this.beforeRender(),t.shift()?.render(this.ctx),this.afterRender();this.onUpdate()}}export{i as App};
//# sourceMappingURL=app.mjs.map
